{{ $menuData := .Site.Data.menu }}

{{ range $menuData }}
  <li {{ if eq .type "link" }}class="font-bold"{{ end }}>
    {{ if eq .type "dropdown" }}
      <details>
        <summary class="font-bold">{{ .title }}</summary>
        <ul class="p-2 w-max md:shadow-top-left-to-bottom-right md:bg-[#15161C] bg-transparent">
          {{ range .items }}
            <li class="icon-target">
              <a
                href="{{- if not .external -}}{{ $.Site.BaseURL }}{{- end -}}{{ .url }}"
                {{ if .external }}target="_blank"{{ end }}>
                <span class="fa-solid {{ .icon }} mr-2"></span>
                {{ .title }}
                {{- if .external -}}
                  <svg width="24px" height="24px" viewBox="0 0 24 24" style="cursor:pointer">
                    <g stroke-width="2.1" stroke="#cecece" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <polyline points="17 13.5 17 19.5 5 19.5 5 7.5 11 7.5"></polyline>
                      <path d="M14,4.5 L20,4.5 L20,10.5 M20,4.5 L11,13.5"></path>
                    </g>
                  </svg>
                {{- end -}}
              </a>
            </li>
          {{ end }}
        </ul>
      </details>
    {{ else }}
      <a href="{{ $.Site.BaseURL }}{{ .url }}">{{ .title }}</a>
    {{ end }}
  </li>
{{ end }}


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const detailsElements = document.querySelectorAll("details");

    function closeAllDropdowns() {
      detailsElements.forEach((detail) => {
        detail.removeAttribute("open");
      });
    }

    detailsElements.forEach((detail) => {
      detail.addEventListener("toggle", function (event) {
        event.stopPropagation();
        if (this.open) {
          detailsElements.forEach((otherDetail) => {
            if (otherDetail !== this) {
              otherDetail.removeAttribute("open");
            }
          });
        }
      });
    });

    document.addEventListener("click", function (event) {
      if (!event.target.closest("details")) {
        closeAllDropdowns();
      }
    });
  });
</script>
